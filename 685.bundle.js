"use strict";(self.webpackChunkcboy_blog=self.webpackChunkcboy_blog||[]).push([[685],{685:function(e,o,p){p.r(o),p.d(o,{default:function(){return a}});var c=p(762);const t={class:"component-webpack"},s={};var a=(0,p(314).A)(s,[["render",function(e,o){return(0,c.uX)(),(0,c.CE)("div",t,o[0]||(o[0]=[(0,c.Fv)('<h4>一 webpack 是什么？</h4><p>它是一个打包工具。 噗，完啦？</p><p>来，我们看官方概念: webpack 是一个现代 JavaScript 应用程序的静态模块打包工具。当 webpack 处理应用程序时，它会在内部构建一个 依赖图(dependency graph)，此依赖图会映射项目所需的每个模块，并生成一个或多个 bundle。</p><p>内部如何构建一个依赖图，我们知道 webpack 会配置一个入口，这就是从这入口文件开始， 找到所有被依赖到的文件，比如其他 js / image / json 文件等，然后通过 loader 对这些文件进行处理、编译、打包、优化，生成一个 bundle 或者多个 bundle。</p><h4>它的原理</h4><p>通过以上，主要就是找依赖, 通过配置处理相应环境，根据你的需要配置插件进行优化（如 profill、babel、 miniSize etc) 打包出文件，可以放到服务器上运行。</p><p>关于找依赖，可以想到关于模块化的语法: import 、require、@import etc， 通过解析对应的语法寻找相应的依赖。然后通过读取依赖到的文件，根据对应的 loader 进行处理文件，最后根据你的插件配置，分割，压缩或注入等，根据 output config输出到对应的文件夹。</p><p>这里推荐一篇 <a href="https://juejin.im/entry/5b0e3eba5188251534379615">webpack原理</a> 文章, 下面就提一提我最近遇到的一个很神奇的问题吧</p><h4>关于 <a href="https://webpack.docschina.org/guides/tree-shaking/">tree shaking</a></h4><p>想象抖一抖树，枯萎的叶子就会脱落。 这里指的是把没有用到的代码删除掉，从而减小文件的大小。通过这一优化，在引用多个第三方库时，能够大大的减少你的文件大小，但请确定这个包是没有副作用的。</p><blockquote><p>什么是副作用? 就是在导入时会自行运行一段函数，从而改变了 window 变量啊或者其他的变量以供导入的包能正常运行， 而不是只单单 export 了变量。</p></blockquote><p>它是依赖于 es2015 的 <code>静态导入导出( import / export)</code>。在打包时就会通过 import 确定引用包的 export 导出的某一个变量之一， 在告知没有副作用的情况下，删除掉没有用到的其他的导出代码。</p><blockquote><p>静态导入是指一开始就默认加载这个文件，而不是一步一步执行代码判断逻辑，去导入对应文件</p></blockquote><p>webpack 在生成环境下，默认打开树抖动配置, 如下配置。</p><pre><code>optimization： {\n\tprovidedExports: true,\n\tusedExports: true,\n\tsideEffects: true,\n\tconcatenateModules: true,\n }\n</code></pre><p><code>providedExports</code> 开启 export 导出收集； <code> usedExportts</code> 告诉webpack确定每个模块的已使用导出； <code> concatenateModules</code> 告诉webpack查找模块图的各个部分，这些部分可以安全地连接成一个模块； <code>sideEffects</code> 告诉webpack识别 sideEffects 标志的 package.json 或规则以跳过模块，这些模块在未使用导出时被标记为不包含副作用， 则可以把无副作用的未使用的导出进行删除。</p><p>所以如果你的包无副作用，推荐在 package.json 设置 <code>sideEffects: false</code> 开启树抖动。 注意, 它会删掉样式文件，因为样式文件是没有 export 的。所以我们需要声明样式文件是有副作用的。 在 package.json 中设置：</p><pre><code>sideEffects: [\n\t&#39;*.css&#39;\n]\n</code></pre><blockquote><p>总结，为了利用树木摇晃，你必须： 1 使用ES2015模块语法 (配置 babel 禁止转义 es6 模块语义） 2 将&quot;sideEffects&quot;属性添加到项目的 package.json文件中。 3 配合压缩工具一起使用</p></blockquote><p><a href="https://github.com/cleverboy32/tree-shaking-css">demo</a> 通过配置 <code>webpack.prod.js</code> sideEffects 值， 你可以看到 build 时 main.js 文件的大小发生改变。</p>',20)]))}]])}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjg1LmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoiNktBQWVBLE1BQU0scUJDQ2ZDLEVBQVMsQ0FBQyxFQUtoQixPQUZpQyxFLE9BQUEsR0FBZ0JBLEVBQVEsQ0FBQyxDQUFDLFMsZ0NESmpEQyxFQUFBQSxFQUFBQSxJQTZDSixNQTdDSUMsRUE2Q0pDLEVBQUEsS0FBQUEsRUFBQSxLQTdDTkMsRUFBQUEsRUFBQUEsSUFBQSxpcUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYm95LWJsb2cvLi4vLi4vYmxvZ3MvbWFya2Rvd24vd2VicGFjay5tZCIsIndlYnBhY2s6Ly9jYm95LWJsb2cvLi4vLi4vYmxvZ3MvbWFya2Rvd24vd2VicGFjay5tZD9iNGZjIl0sInNvdXJjZXNDb250ZW50IjpbIjx0ZW1wbGF0ZT48ZGl2IGNsYXNzPVwiY29tcG9uZW50LXdlYnBhY2tcIj48aDQ+5LiAICB3ZWJwYWNrIOaYr+S7gOS5iO+8nzwvaDQ+XG48cD7lroPmmK/kuIDkuKrmiZPljIXlt6XlhbfjgIIg5ZmX77yM5a6M5ZWm77yfPC9wPlxuPHA+5p2l77yM5oiR5Lus55yL5a6Y5pa55qaC5b+1OiAgd2VicGFjayDmmK/kuIDkuKrnjrDku6MgSmF2YVNjcmlwdCDlupTnlKjnqIvluo/nmoTpnZnmgIHmqKHlnZfmiZPljIXlt6XlhbfjgILlvZMgd2VicGFjayDlpITnkIblupTnlKjnqIvluo/ml7bvvIzlroPkvJrlnKjlhoXpg6jmnoTlu7rkuIDkuKog5L6d6LWW5Zu+KGRlcGVuZGVuY3kgZ3JhcGgp77yM5q2k5L6d6LWW5Zu+5Lya5pig5bCE6aG555uu5omA6ZyA55qE5q+P5Liq5qih5Z2X77yM5bm255Sf5oiQ5LiA5Liq5oiW5aSa5LiqIGJ1bmRsZeOAgjwvcD5cbjxwPuWGhemDqOWmguS9leaehOW7uuS4gOS4quS+nei1luWbvu+8jOaIkeS7rOefpemBkyB3ZWJwYWNrIOS8mumFjee9ruS4gOS4quWFpeWPo++8jOi/meWwseaYr+S7jui/meWFpeWPo+aWh+S7tuW8gOWni++8jCDmib7liLDmiYDmnInooqvkvp3otZbliLDnmoTmlofku7bvvIzmr5TlpoLlhbbku5YganMgLyBpbWFnZSAvIGpzb24g5paH5Lu2562J77yM54S25ZCO6YCa6L+HIGxvYWRlciDlr7nov5nkupvmlofku7bov5vooYzlpITnkIbjgIHnvJbor5HjgIHmiZPljIXjgIHkvJjljJbvvIznlJ/miJDkuIDkuKogYnVuZGxlIOaIluiAheWkmuS4qiBidW5kbGXjgII8L3A+XG48aDQ+5a6D55qE5Y6f55CGPC9oND5cbjxwPumAmui/h+S7peS4iu+8jOS4u+imgeWwseaYr+aJvuS+nei1liwg6YCa6L+H6YWN572u5aSE55CG55u45bqU546v5aKD77yM5qC55o2u5L2g55qE6ZyA6KaB6YWN572u5o+S5Lu26L+b6KGM5LyY5YyW77yI5aaCIHByb2ZpbGzjgIFiYWJlbOOAgSBtaW5pU2l6ZSBldGMpIOaJk+WMheWHuuaWh+S7tu+8jOWPr+S7peaUvuWIsOacjeWKoeWZqOS4iui/kOihjOOAgjwvcD5cbjxwPuWFs+S6juaJvuS+nei1lu+8jOWPr+S7peaDs+WIsOWFs+S6juaooeWdl+WMlueahOivreazlTogaW1wb3J0IOOAgXJlcXVpcmXjgIFAaW1wb3J0IGV0Y++8jCDpgJrov4fop6PmnpDlr7nlupTnmoTor63ms5Xlr7vmib7nm7jlupTnmoTkvp3otZbjgILnhLblkI7pgJrov4for7vlj5bkvp3otZbliLDnmoTmlofku7bvvIzmoLnmja7lr7nlupTnmoQgbG9hZGVyIOi/m+ihjOWkhOeQhuaWh+S7tu+8jOacgOWQjuagueaNruS9oOeahOaPkuS7tumFjee9ru+8jOWIhuWJsu+8jOWOi+e8qeaIluazqOWFpeetie+8jOagueaNriBvdXRwdXQgY29uZmln6L6T5Ye65Yiw5a+55bqU55qE5paH5Lu25aS544CCPC9wPlxuPHA+6L+Z6YeM5o6o6I2Q5LiA56+HIDxhIGhyZWY9XCJodHRwczovL2p1ZWppbi5pbS9lbnRyeS81YjBlM2ViYTUxODgyNTE1MzQzNzk2MTVcIj53ZWJwYWNr5Y6f55CGPC9hPiDmlofnq6AsIOS4i+mdouWwseaPkOS4gOaPkOaIkeacgOi/kemBh+WIsOeahOS4gOS4quW+iOelnuWlh+eahOmXrumimOWQpzwvcD5cbjxoND7lhbPkuo4gPGEgaHJlZj1cImh0dHBzOi8vd2VicGFjay5kb2NzY2hpbmEub3JnL2d1aWRlcy90cmVlLXNoYWtpbmcvXCI+dHJlZSBzaGFraW5nPC9hPjwvaDQ+XG48cD7mg7PosaHmipbkuIDmipbmoJHvvIzmnq/okI7nmoTlj7blrZDlsLHkvJrohLHokL3jgIIg6L+Z6YeM5oyH55qE5piv5oqK5rKh5pyJ55So5Yiw55qE5Luj56CB5Yig6Zmk5o6J77yM5LuO6ICM5YeP5bCP5paH5Lu255qE5aSn5bCP44CC6YCa6L+H6L+Z5LiA5LyY5YyW77yM5Zyo5byV55So5aSa5Liq56ys5LiJ5pa55bqT5pe277yM6IO95aSf5aSn5aSn55qE5YeP5bCR5L2g55qE5paH5Lu25aSn5bCP77yM5L2G6K+356Gu5a6a6L+Z5Liq5YyF5piv5rKh5pyJ5Ymv5L2c55So55qE44CCPC9wPlxuPGJsb2NrcXVvdGU+XG48cD7ku4DkuYjmmK/lia/kvZznlKg/XG7lsLHmmK/lnKjlr7zlhaXml7bkvJroh6rooYzov5DooYzkuIDmrrXlh73mlbDvvIzku47ogIzmlLnlj5jkuoYgd2luZG93IOWPmOmHj+WViuaIluiAheWFtuS7lueahOWPmOmHj+S7peS+m+WvvOWFpeeahOWMheiDveato+W4uOi/kOihjO+8jCDogIzkuI3mmK/lj6rljZXljZUgZXhwb3J0IOS6huWPmOmHj+OAgjwvcD5cbjwvYmxvY2txdW90ZT5cbjxwPuWug+aYr+S+nei1luS6jiBlczIwMTUg55qEIDxjb2RlPumdmeaAgeWvvOWFpeWvvOWHuiggaW1wb3J0IC8gZXhwb3J0KTwvY29kZT7jgILlnKjmiZPljIXml7blsLHkvJrpgJrov4cgaW1wb3J0IOehruWumuW8leeUqOWMheeahCBleHBvcnQg5a+85Ye655qE5p+Q5LiA5Liq5Y+Y6YeP5LmL5LiA77yMIOWcqOWRiuefpeayoeacieWJr+S9nOeUqOeahOaDheWGteS4i++8jOWIoOmZpOaOieayoeacieeUqOWIsOeahOWFtuS7lueahOWvvOWHuuS7o+eggeOAgjwvcD5cbjxibG9ja3F1b3RlPlxuPHA+6Z2Z5oCB5a+85YWl5piv5oyH5LiA5byA5aeL5bCx6buY6K6k5Yqg6L296L+Z5Liq5paH5Lu277yM6ICM5LiN5piv5LiA5q2l5LiA5q2l5omn6KGM5Luj56CB5Yik5pat6YC76L6R77yM5Y675a+85YWl5a+55bqU5paH5Lu2PC9wPlxuPC9ibG9ja3F1b3RlPlxuPHA+d2VicGFjayDlnKjnlJ/miJDnjq/looPkuIvvvIzpu5jorqTmiZPlvIDmoJHmipbliqjphY3nva4sIOWmguS4i+mFjee9ruOAgjwvcD5cbjxwcmUgdi1wcmU9XCJcIj48Y29kZT5vcHRpbWl6YXRpb27vvJoge1xuXHRwcm92aWRlZEV4cG9ydHM6IHRydWUsXG5cdHVzZWRFeHBvcnRzOiB0cnVlLFxuXHRzaWRlRWZmZWN0czogdHJ1ZSxcblx0Y29uY2F0ZW5hdGVNb2R1bGVzOiB0cnVlLFxuIH1cbjwvY29kZT48L3ByZT5cbjxwPjxjb2RlPnByb3ZpZGVkRXhwb3J0czwvY29kZT4g5byA5ZCvIGV4cG9ydCDlr7zlh7rmlLbpm4bvvJtcbjxjb2RlPiB1c2VkRXhwb3J0dHM8L2NvZGU+IOWRiuiviXdlYnBhY2vnoa7lrprmr4/kuKrmqKHlnZfnmoTlt7Lkvb/nlKjlr7zlh7rvvJtcbjxjb2RlPiBjb25jYXRlbmF0ZU1vZHVsZXM8L2NvZGU+ICDlkYror4l3ZWJwYWNr5p+l5om+5qih5Z2X5Zu+55qE5ZCE5Liq6YOo5YiG77yM6L+Z5Lqb6YOo5YiG5Y+v5Lul5a6J5YWo5Zyw6L+e5o6l5oiQ5LiA5Liq5qih5Z2X77ybXG48Y29kZT5zaWRlRWZmZWN0czwvY29kZT4g5ZGK6K+Jd2VicGFja+ivhuWIqyBzaWRlRWZmZWN0cyDmoIflv5fnmoQgcGFja2FnZS5qc29uIOaIluinhOWImeS7pei3s+i/h+aooeWdl++8jOi/meS6m+aooeWdl+WcqOacquS9v+eUqOWvvOWHuuaXtuiiq+agh+iusOS4uuS4jeWMheWQq+WJr+S9nOeUqO+8jCDliJnlj6/ku6Xmiorml6Dlia/kvZznlKjnmoTmnKrkvb/nlKjnmoTlr7zlh7rov5vooYzliKDpmaTjgII8L3A+XG48cD7miYDku6XlpoLmnpzkvaDnmoTljIXml6Dlia/kvZznlKjvvIzmjqjojZDlnKggcGFja2FnZS5qc29uIOiuvue9riA8Y29kZT5zaWRlRWZmZWN0czogZmFsc2U8L2NvZGU+IOW8gOWQr+agkeaKluWKqOOAglxu5rOo5oSPLCDlroPkvJrliKDmjonmoLflvI/mlofku7bvvIzlm6DkuLrmoLflvI/mlofku7bmmK/msqHmnIkgZXhwb3J0IOeahOOAguaJgOS7peaIkeS7rOmcgOimgeWjsOaYjuagt+W8j+aWh+S7tuaYr+acieWJr+S9nOeUqOeahOOAglxu5ZyoIHBhY2thZ2UuanNvbiDkuK3orr7nva7vvJo8L3A+XG48cHJlIHYtcHJlPVwiXCI+PGNvZGU+c2lkZUVmZmVjdHM6IFtcblx0JyouY3NzJ1xuXVxuPC9jb2RlPjwvcHJlPlxuPGJsb2NrcXVvdGU+XG48cD7mgLvnu5PvvIzkuLrkuobliKnnlKjmoJHmnKjmkYfmmYPvvIzkvaDlv4XpobvvvJpcbjEg5L2/55SoRVMyMDE15qih5Z2X6K+t5rOVICjphY3nva4gYmFiZWwg56aB5q2i6L2s5LmJIGVzNiDmqKHlnZfor63kuYnvvIlcbjIg5bCGXCJzaWRlRWZmZWN0c1wi5bGe5oCn5re75Yqg5Yiw6aG555uu55qEIHBhY2thZ2UuanNvbuaWh+S7tuS4reOAglxuMyDphY3lkIjljovnvKnlt6XlhbfkuIDotbfkvb/nlKg8L3A+XG48L2Jsb2NrcXVvdGU+XG48cD48YSBocmVmPVwiaHR0cHM6Ly9naXRodWIuY29tL2NsZXZlcmJveTMyL3RyZWUtc2hha2luZy1jc3NcIj5kZW1vPC9hPlxu6YCa6L+H6YWN572uICA8Y29kZT53ZWJwYWNrLnByb2QuanM8L2NvZGU+IHNpZGVFZmZlY3RzIOWAvO+8jCDkvaDlj6/ku6XnnIvliLAgYnVpbGQg5pe2IG1haW4uanMg5paH5Lu255qE5aSn5bCP5Y+R55Sf5pS55Y+Y44CCPC9wPlxuPC9kaXY+PC90ZW1wbGF0ZT4iLCJpbXBvcnQgeyByZW5kZXIgfSBmcm9tIFwiLi93ZWJwYWNrLm1kP3Z1ZSZ0eXBlPXRlbXBsYXRlJmlkPTcxODVlYWMwXCJcbmNvbnN0IHNjcmlwdCA9IHt9XG5cbmltcG9ydCBleHBvcnRDb21wb25lbnQgZnJvbSBcIi4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS92dWUtbG9hZGVyQDE3LjQuMl9AdnVlK2NvbXBpbGVyLXNmY0AzLjUuMTJfdnVlQDMuNS4xMl90eXBlc2NyaXB0QDUuNi4zX193ZWJwYWNrQDUuOTUuMF93ZWJwYWNrLWNsaUA1LjEuNF8vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvZGlzdC9leHBvcnRIZWxwZXIuanNcIlxuY29uc3QgX19leHBvcnRzX18gPSAvKiNfX1BVUkVfXyovZXhwb3J0Q29tcG9uZW50KHNjcmlwdCwgW1sncmVuZGVyJyxyZW5kZXJdXSlcblxuZXhwb3J0IGRlZmF1bHQgX19leHBvcnRzX18iXSwibmFtZXMiOlsiY2xhc3MiLCJzY3JpcHQiLCJfY3JlYXRlRWxlbWVudEJsb2NrIiwiX2hvaXN0ZWRfMSIsIl9jYWNoZSIsIl9jcmVhdGVTdGF0aWNWTm9kZSJdLCJzb3VyY2VSb290IjoiIn0=